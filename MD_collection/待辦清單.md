# 語音辨識功能改進待辦清單

## 已完成項目 ✅

### 1. 改善語音辨識輸出問題
- **問題描述**: 語音辨識只輸出單字即顯示，需要加入最小字數/時間緩衝或按詞組輸出
- **相關檔案**: `js/subtitles.js`, `teacher.html`, `js/presentation.js`
- **實作內容**:
  - 增加 `MIN_WORD_COUNT` (3個字) 和 `MIN_CHAR_COUNT` (4個字元) 的最小輸出限制
  - 調整 `INTERIM_COMMIT_MS` 為 3000ms，增加緩衝時間
  - 修改 `INTERIM_COMMIT_DELTA` 為 8，提高字數差異門檻
  - 在 `accumulateInterim` 函數中加入字數和字元數檢查
- **狀態**: ✅ 已完成

### 2. 自動重啟辨識功能
- **問題描述**: 麥克風停止或模型停止後，需要在2秒內自動重啟辨識
- **相關檔案**: `js/player.js`, `js/presentation.js`
- **實作內容**:
  - 新增 `autoRestartTimer` 和 `AUTO_RESTART_DELAY_MS` (2000ms) 變數
  - 實作 `startAutoRestartTimer()`, `stopAutoRestartTimer()`, `updateActivityTime()`, `restartRecording()` 函數
  - 在靜音監控中加入活動時間更新和自動重啟邏輯
  - 在所有語音辨識結果處理點加入活動時間更新
  - 在停止錄音時確保清除自動重啟計時器
- **狀態**: ✅ 已完成

## 功能特色

### 改進的語音辨識緩衝機制
- 防止單字立即顯示，確保至少3個字或4個字元才輸出
- 增加時間緩衝，避免過於頻繁的文字更新
- 保持語音辨識的流暢性和準確性

### 智能自動重啟功能
- 監控麥克風活動狀態
- 在2秒無活動後自動重啟辨識
- 支援本地和遠端語音辨識服務
- 確保辨識服務的持續性和穩定性

## 測試建議
1. 測試短語輸入是否正確緩衝
2. 測試長時間靜音後的自動重啟功能
3. 驗證本地和遠端辨識服務的切換
4. 確認停止錄音時所有計時器正確清除